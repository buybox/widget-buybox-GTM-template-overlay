___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "BUY.BOX Where To Buy Widget Script",
  "brand": {
    "id": "brand_dummy",
    "displayName": "BUY.BOX",
    "thumbnail": "data:image/png;base64,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"
  },
  "description": "This adds BUY.BOX Where To Buy widget script on your site.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "SELECT",
    "name": "bb-type",
    "displayName": "Widget type",
    "selectItems": [
      {
        "value": "overlay",
        "displayValue": "overlay"
      }
    ],
    "simpleValueType": true,
    "defaultValue": "overlay"
  },
  {
    "type": "CHECKBOX",
    "name": "bb-show",
    "checkboxText": "Show widget on page load",
    "simpleValueType": true,
    "help": "If enabled, widget will be automatically shown on page load or after calling window.bb.forceReload(). Only a single widget can be shown this way.",
    "enablingConditions": [
      {
        "paramName": "bb-type",
        "paramValue": "overlay",
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "SELECT",
    "name": "bb-version",
    "displayName": "Widget version",
    "selectItems": [
      {
        "value": "latest",
        "displayValue": "Latest"
      },
      {
        "value": "5.1",
        "displayValue": "5.1"
      },
      {
        "value": "5.0",
        "displayValue": "5.0"
      }
    ],
    "simpleValueType": true,
    "defaultValue": "latest"
  },
  {
    "type": "SELECT",
    "name": "bb-language",
    "displayName": "Widget language",
    "selectItems": [
      {
        "value": "pl",
        "displayValue": "Polish"
      },
      {
        "value": "en",
        "displayValue": "English"
      },
      {
        "value": "lt",
        "displayValue": "Lithuanian"
      },
      {
        "value": "lv",
        "displayValue": "Latvian"
      },
      {
        "value": "et",
        "displayValue": "Estonian"
      },
      {
        "value": "de",
        "displayValue": "German"
      }
    ],
    "simpleValueType": true,
    "defaultValue": "pl"
  },
  {
    "type": "TEXT",
    "name": "id",
    "displayName": "Document element ID",
    "simpleValueType": true,
    "help": "Document element ID that will be used as target element to show widget. If not provided floating button will be added to page."
  },
  {
    "type": "TEXT",
    "name": "bb-id",
    "displayName": "Widget configuration ID",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ]
  },
  {
    "type": "CHECKBOX",
    "name": "hasVariants",
    "checkboxText": "Display multiple product variants?",
    "simpleValueType": true
  },
  {
    "type": "TEXT",
    "name": "bb-number",
    "displayName": "Product EAN",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ],
    "enablingConditions": [
      {
        "paramName": "hasVariants",
        "paramValue": false,
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "bb-var-default",
    "displayName": "Default variant",
    "simpleValueType": true,
    "enablingConditions": [
      {
        "paramName": "hasVariants",
        "paramValue": true,
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "varNameOptions",
    "displayName": "Variant option names",
    "groupStyle": "ZIPPY_OPEN",
    "subParams": [
      {
        "type": "TEXT",
        "name": "bb-var-name-opt1",
        "displayName": "Option 1 name",
        "simpleValueType": true
      },
      {
        "type": "TEXT",
        "name": "bb-var-name-opt2",
        "displayName": "Option 2 name",
        "simpleValueType": true
      },
      {
        "type": "TEXT",
        "name": "bb-var-name-opt3",
        "displayName": "Option 3 name",
        "simpleValueType": true
      },
      {
        "type": "TEXT",
        "name": "bb-var-name-opt4",
        "displayName": "Option 4 name",
        "simpleValueType": true
      },
      {
        "type": "TEXT",
        "name": "bb-var-name-opt5",
        "displayName": "Option 5 name",
        "simpleValueType": true
      }
    ],
    "enablingConditions": [
      {
        "paramName": "hasVariants",
        "paramValue": true,
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "PARAM_TABLE",
    "name": "variants",
    "displayName": "Variants",
    "paramTableColumns": [
      {
        "param": {
          "type": "TEXT",
          "name": "bb-var-value-opt1",
          "displayName": "Option 1 value",
          "simpleValueType": true,
          "valueValidators": [
            {
              "type": "NON_EMPTY"
            }
          ]
        },
        "isUnique": false
      },
      {
        "param": {
          "type": "TEXT",
          "name": "bb-var-value-opt2",
          "displayName": "Option 2 value",
          "simpleValueType": true
        },
        "isUnique": false
      },
      {
        "param": {
          "type": "TEXT",
          "name": "bb-var-value-opt3",
          "displayName": "Option 3 value",
          "simpleValueType": true
        },
        "isUnique": false
      },
      {
        "param": {
          "type": "TEXT",
          "name": "bb-var-value-opt4",
          "displayName": "Option 4 value",
          "simpleValueType": true
        },
        "isUnique": false
      },
      {
        "param": {
          "type": "TEXT",
          "name": "bb-var-value-opt5",
          "displayName": "Option 5 value",
          "simpleValueType": true
        },
        "isUnique": false
      },
      {
        "param": {
          "type": "TEXT",
          "name": "bb-var-number",
          "displayName": "Product EAN",
          "simpleValueType": true,
          "valueValidators": [
            {
              "type": "NON_EMPTY"
            }
          ]
        },
        "isUnique": false
      },
      {
        "param": {
          "type": "SELECT",
          "name": "bb-var-show-extra",
          "displayName": "Show product information",
          "macrosInSelect": false,
          "selectItems": [
            {
              "value": true,
              "displayValue": "Show"
            },
            {
              "value": false,
              "displayValue": "Do not show"
            }
          ],
          "simpleValueType": true
        },
        "isUnique": false
      },
      {
        "param": {
          "type": "TEXT",
          "name": "bb-var-price-top-limit",
          "displayName": "Maximum price",
          "simpleValueType": true
        },
        "isUnique": false
      },
      {
        "param": {
          "type": "TEXT",
          "name": "bb-var-price-bottom-limit",
          "displayName": "Minimum price",
          "simpleValueType": true
        },
        "isUnique": false
      },
      {
        "type": "SELECT",
        "name": "bb-sort",
        "displayName": "Sort order",
        "selectItems": [
          {
            "value": "ascending",
            "displayValue": "Ascending"
          },
          {
            "value": "descending",
            "displayValue": "Descending"
          },
          {
            "value": "random",
            "displayValue": "Random"
          }
        ],
        "simpleValueType": true,
        "notSetText": "Default",
        "help": "Sorting offers will respect shops' weight order configuration"
      },
      {
        "param": {
          "type": "TEXT",
          "name": "bb-var-abpar1",
          "displayName": "Additional user parameter (abpar1)",
          "simpleValueType": true
        },
        "isUnique": false
      },
      {
        "param": {
          "type": "TEXT",
          "name": "bb-var-abpar2",
          "displayName": "Additional user parameter (abpar2)",
          "simpleValueType": true
        },
        "isUnique": false
      },
      {
        "param": {
          "type": "TEXT",
          "name": "bb-var-abpar3",
          "displayName": "Additional user parameter (abpar3)",
          "simpleValueType": true
        },
        "isUnique": false
      },
      {
        "param": {
          "type": "SELECT",
          "name": "bb-var-use-tabs",
          "displayName": "Divide formats into tabs",
          "selectItems": [
            {
              "value": true,
              "displayValue": "Yes"
            },
            {
              "value": false,
              "displayValue": "No"
            }
          ],
          "simpleValueType": true,
          "notSetText": "Default"
        },
        "isUnique": false
      },
      {
        "param": {
          "type": "TEXT",
          "name": "bb-var-default-tab",
          "displayName": "Default tab ID",
          "simpleValueType": true
        },
        "isUnique": false
      }
    ],
    "enablingConditions": [
      {
        "paramName": "hasVariants",
        "paramValue": true,
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "additionalSettings",
    "displayName": "Additional settings",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "SELECT",
        "name": "bb-show-extra",
        "displayName": "Show product information",
        "macrosInSelect": false,
        "selectItems": [
          {
            "value": true,
            "displayValue": "Show"
          },
          {
            "value": false,
            "displayValue": "Do not show"
          }
        ],
        "simpleValueType": true,
        "notSetText": "",
        "enablingConditions": [
          {
            "paramName": "hasVariants",
            "paramValue": false,
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "bb-price-top-limit",
        "displayName": "Maximum price",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "hasVariants",
            "paramValue": false,
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "bb-price-bottom-limit",
        "displayName": "Minimum price",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "hasVariants",
            "paramValue": false,
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "bb-abpar1",
        "displayName": "Additional user parameter (abpar1)",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "hasVariants",
            "paramValue": false,
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "bb-abpar2",
        "displayName": "Additional user parameter (abpar2)",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "hasVariants",
            "paramValue": false,
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "bb-abpar3",
        "displayName": "Additional user parameter (abpar3)",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "hasVariants",
            "paramValue": false,
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "bb-show-if-empty",
        "displayName": "Element ID to display when widget has no offers",
        "simpleValueType": true,
        "enablingConditions": []
      },
      {
        "type": "TEXT",
        "name": "floating-btn-text",
        "displayName": "Floating button text",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "id",
            "paramValue": "",
            "type": "NOT_PRESENT"
          }
        ]
      },
      {
        "type": "SELECT",
        "name": "bb-use-tabs",
        "displayName": "Divide formats into tabs",
        "selectItems": [
          {
            "value": true,
            "displayValue": "Yes"
          },
          {
            "value": false,
            "displayValue": "No"
          }
        ],
        "simpleValueType": true,
        "notSetText": "Default"
      },
      {
        "type": "TEXT",
        "name": "bb-default-tab",
        "displayName": "Default tab ID",
        "simpleValueType": true
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const log = require('logToConsole');
const queryPermission = require('queryPermission');
const injectScript = require('injectScript');
const copyFromWindow = require('copyFromWindow');
const setInWindow = require('setInWindow');

const widgetUrl = 'https://buybox.click/js/widget.min.js';

const initData = () => {
  let bbWidgets = copyFromWindow('bbWidgets');
  if (!bbWidgets) {
    bbWidgets = [];
  }
  const parsedData = {};
  for (let key in data) {
    if (key !== 'hasVariants' && key !== 'variants') {
      parsedData[key] = data[key]; 
    }
  }
  if (data.hasVariants) {
    data.variants.forEach((variant, variantIdx) => {
      for (let fieldKey in variant) {
        if (variant[fieldKey] !== undefined && variant[fieldKey] !== '') {
          const indexedKey = fieldKey.replace('bb-var-', 'bb-var' + (variantIdx + 1) + '-');
          parsedData[indexedKey] = variant[fieldKey];
        }
      }
    });
  }
  bbWidgets.push(parsedData);
  setInWindow('bbWidgets', bbWidgets, true);
};

const onFailure = () => {
  log('Unable to inject widget script!');
  data.gtmOnFailure();
};

const checkPermissions = () => {
  if (!queryPermission('inject_script', widgetUrl)) {
    log('Unable to inject widget script due to missing permissions!');
    return false;
  }
  if (!queryPermission('access_globals', 'readwrite', 'bbWidgets')) {
    log('Unable to access globals due to missing permissions!');
    return false;
  }
  return true;
};

if (checkPermissions()) {
  initData();
  injectScript(widgetUrl, undefined, onFailure, 'widget');
  data.gtmOnSuccess();
} else {
  data.gtmOnFailure();
}


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "all"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://buybox.click/js/widget.min.js"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "bbWidgets"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 28/07/2020, 06:05:26


